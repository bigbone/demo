<html>

<head>
    <meta charset="utf-8">
</head>

<body>
    <div>
        <h3>跨域（同源策略）</h3>
        <h4>跨域</h4>
        <p>huodong.weibo.com 和 weibo.com</p>
        <p>huodong.weibo.com 和 huodong.weibo.com:8989</p>
        <p>https://huodong.weibo.com 和 http://huodong.weibo.com</p>
        <h4>不跨域</h4>
        <p>https://huodong.weibo.com 和 https://huodong.weibo.com</p>
        <p><input type="button" value="call ifrmeb" onclick="calliframe()"></p>
    </div>
    <iframe src="iframeb.html" name="iframeb"></iframe>
    <script type="text/javascript">
        function testcallback() {
            console.log('testcallback');
        }

        function calliframe() {
            frames['iframeb'].window.test();
        }
    </script>

    <h3><a href="http://demo.weibo.com/test/weibo/upload.html">上传图片的流程</a></h3>
    <h3>jsonp</h3>
    <iframe src="iframejsonp.html" name="iframeb"></iframe>

    <h3><a href="http://www.ruanyifeng.com/blog/2016/04/cors.html">CROS</a></h3>
    <p>简单请求</p>
    <p>xhr.withCredentials = true</p>
    <p>Access-Control-Allow-Credentials</p>
    <p>localstorage 同域跨标签通讯（window.addEventListener('storage', (e) => console.log(e)) ）/localStorage.setItem('weibo', '1')
    </p>
    <p>websocket/长轮询<a href="http://demo.weibo.com/chat/client/">例子</a></p>

    <h3>
        <a href="https://www.cnblogs.com/dailc/p/5931324.html#hybrid_3_5">JSBridge原理</a></h3>
    <p>
        <img src="https://dailc.github.io/staticResource/blog/hybrid/jsbridge/img_hybrid_base_jsbridgePrinciple_1.png">
    </p>
    <p>
        js 调用native <br>在Android中(WebViewClient里),通过shouldoverrideurlloading可以捕获到url scheme的触发<br>
        <img src="android.png"><br> iOS中,UIWebView有个特性：在UIWebView内发起的所有网络请求，都可以通过delegate函数在Native层得到通知
        <br><img src="ios.png">
    </p>
    <p> native 调用js <br> JSBridge._handleMessageFromNative(messageJSON);
        <br> {handlerName:api名,data:数据,callbackId:回调id}
    </p>
    <p>注意</p>
    <p>1.支持的客户端版本</p>
    <p>2.android jsbridge 会晚加载。通过jsbridgeready事件来触发</p>
    <p>3.保存图片到本地需要执行完后再调用，要不会花</p>
    <iframe src="../weibo/calener.html"></iframe>
    <h3><a href="https://gitlab.weibo.cn/webBrowser/JSBridge">wiki</a></h3>
</body>

</html>